<html>
<head>
  <title>Health Hunters - West Nile Virus in Chicago</title>
  <link rel="stylesheet" href="css/leaflet.css"/>
  <link rel="stylesheet" href="css/MarkerCluster.css"/>
  <script src="js/leaflet.js"></script>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/0.4.0/leaflet.markercluster.js'></script>
  <script src="js/jquery-2.1.1.min.js"></script>
  <style>
    #map{ height: 100% }
  </style>
</head>
<body>
 
  <div id="map"></div>
 
  <script>
 
  // initialize the map
  var map = L.map('map').setView([41.8369, -87.6847], 10);
 
  // load a tile layer
  L.tileLayer('http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
  maxZoom: 15,
  attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

// Base Chloropleth Map    
  $.getJSON("zipcode.geojson",function(hoodData){
    L.geoJson( hoodData, {
      style: function(feature){
        var fillColor,
            density = feature.properties.density;
        if ( density > 80 ) fillColor = "#006837";
        else if ( density > 40 ) fillColor = "#31a354";
        else if ( density > 20 ) fillColor = "#78c679";
        else if ( density > 10 ) fillColor = "#c2e699";
        else if ( density > 0 ) fillColor = "#ffffcc";
        else fillColor = "#f7f7f7";  // no data
        return { color: "#999", weight: 1, fillColor: fillColor, fillOpacity: .6 };
      },
      onEachFeature: function( feature, layer ){
        layer.bindPopup( "<strong>" + feature.properties.Name + "</strong><br/>" + feature.properties.density + " mosquitoes per square mile" )
      }
    }).addTo(map);
  });

// load GeoJSON from an external file
/*
  $.getJSON("Chicago.geojson",function(data){
    var ratIcon = L.icon({
    iconUrl: 'Mosquito.png',
    iconSize: [40,30]
    });
    var chicago = L.geoJson(data,{
    pointToLayer: function(feature,latlng){
    var marker = L.marker(latlng,{icon: ratIcon});
    marker.bindPopup(feature.properties.Address + '<br/>' + feature.properties.Number_of_Mosquitoes);
    return marker;
    }
    });

  var clusters = L.markerClusterGroup();
  clusters.addLayer(chicago);
  map.addLayer(clusters);

  });
*/

//Circle Marker
$.getJSON("Chicago.geojson",function(data){
var geojsonMarkerOptions = {
    radius: 8,
    fillColor: "#ff7800",
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8,
    }

var chicago = L.geoJson(data, {
    pointToLayer: function (feature, latlng) {
    var marker = L.circleMarker(latlng,geojsonMarkerOptions);
    marker.bindPopup('<b>Address: </b>'+ feature.properties.Address + '<br/><b>Date: </b>'+feature.properties.Date + '<br/><b>Number of Mosquitos: </b>' + feature.properties["Number of Mosquitoes"]);
    return marker;
    }
})

  var clusters = L.markerClusterGroup();
  clusters.addLayer(chicago);
  map.addLayer(clusters);

});
  </script>
</body>
</html>
